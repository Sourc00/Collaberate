{% extends "base.html" %}

{% block title %}Search - Collaberate{% endblock %}

{% block content %}
    <h1>Search for Projects or Collaborators</h1>
    <form method="GET" action="{{ url_for('search') }}">
        <input type="text" name="q" placeholder="Search by skill, project name, or username" value="{{ query }}">
        <button type="submit">Search</button>
    </form>

    <h2>Search Results</h2>
    <div class="search-results">
        <h3>Users</h3>
        {% if users.items %}
            {% for user in users.items %}
                <div class="result-item">
                    <h4>{{ user.username }}</h4>
                    <p>Skills: {{ user.skills }}</p>
                    <a href="{{ url_for('profile', username=user.username) }}">View Profile</a>
                </div>
            {% endfor %}
            {{ render_pagination(users, 'search', q=query) }}
        {% else %}
            <p>No users found.</p>
        {% endif %}

        <h3>Projects</h3>
        {% if projects.items %}
            {% for project in projects.items %}
                <div class="result-item">
                    <h4>{{ project.title }}</h4>
                    <p>{{ project.description[:100] }}...</p>
                    <p>Skills needed: {{ project.skills_needed }}</p>
                    <a href="{{ url_for('project_details', project_id=project.id) }}">View Project</a>
                </div>
            {% endfor %}
            {{ render_pagination(projects, 'search', q=query) }}
        {% else %}
            <p>No projects found.</p>
        {% endif %}
    </div>

    {% macro render_pagination(pagination, endpoint, **kwargs) %}
      <nav aria-label="Page navigation">
        <ul class="pagination">
          {% for page in pagination.iter_pages() %}
            {% if page %}
              <li class="page-item {% if page == pagination.page %}active{% endif %}">
                <a class="page-link" href="{{ url_for(endpoint, page=page, **kwargs) }}">{{ page }}</a>
              </li>
            {% else %}
              <li class="page-item disabled"><span class="page-link">...</span></li>
            {% endif %}
          {% endfor %}
        </ul>
      </nav>
    {% endmacro %}
{% endblock %}